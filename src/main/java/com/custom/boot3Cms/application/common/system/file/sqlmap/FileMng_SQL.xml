<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.custom.boot3Cms.application.common.system.file.mapper.FileMngMapper">

    <!-- 파일 목록 -->
    <select id="getFileList" resultType="com.custom.boot3Cms.application.common.system.file.vo.FileMngVO">
        SELECT
            FILE_SEQ,
            TABLE_NM,
            TABLE_SEQ,
            FILE_TYPE,
            FILE_SYS_NM,
            FILE_NM,
            FILE_PATH,
            INPT_SEQ,
            INPT_DATE
        FROM TB_FILES TF
        WHERE 1=1
        AND TF.TABLE_NM = #{table_nm}
        AND TF.TABLE_SEQ = #{table_seq}
        ORDER BY TF.FILE_SEQ ASC
    </select>

    <!-- 파일 단건 정보 가져오기 -->
    <select id="getFileDetail" resultType="com.custom.boot3Cms.application.common.system.file.vo.FileMngVO">
        SELECT
            FILE_SEQ,
            TABLE_NM,
            TABLE_SEQ,
            FILE_SYS_NM,
            FILE_NM,
            FILE_PATH
        FROM TB_FILES TF
        WHERE 1=1
        AND TF.FILE_SEQ = #{file_seq}
    </select>



    <!-- 파일 등록 -->
    <insert id="setFile" parameterType="com.custom.boot3Cms.application.common.system.file.vo.FileMngVO">
        INSERT INTO TB_FILES
        (
            FILE_SEQ,
            TABLE_NM,
            TABLE_SEQ,
            FILE_TYPE,
            FILE_SYS_NM,
            FILE_NM,
            FILE_PATH,
            INPT_SEQ,
            INPT_DATE
        )
        VALUES
        (
            TB_FILES_SEQ.nextval,
            #{table_nm},
            #{table_seq},
            #{file_type},
            #{file_sys_nm},
            #{file_nm},
            #{file_path},
            #{inpt_seq},
            SYSDATE
        )
    </insert>

    <!-- 파일 단건 삭제 -->
    <delete id="delFile" parameterType="com.custom.boot3Cms.application.common.system.file.vo.FileMngVO">
        DELETE FROM TB_FILES
        WHERE TABLE_NM = #{table_nm}
        AND TABLE_SEQ = #{table_seq}
        AND FILE_SEQ = #{file_seq}
    </delete>

    <!-- 파일 전체 삭제 (TABLE/SEQ) -->
    <delete id="delFiles" parameterType="com.custom.boot3Cms.application.common.system.file.vo.FileMngVO">
        DELETE FROM TB_FILES
        WHERE TABLE_NM = #{table_nm}
        AND TABLE_SEQ = #{table_seq}
    </delete>

</mapper>
